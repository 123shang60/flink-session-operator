---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.8.0
  creationTimestamp: null
  name: flinksessions.flink.shang12360.cn
spec:
  group: flink.shang12360.cn
  names:
    kind: FlinkSession
    listKind: FlinkSessionList
    plural: flinksessions
    singular: flinksession
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.ready
      name: Ready
      type: boolean
    - jsonPath: .status.port
      name: Port
      type: integer
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: FlinkSession is the Schema for the flinksessions API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: FlinkSessionSpec defines the desired state of FlinkSession
            properties:
              balancedSchedule:
                description: 均衡调度策略 ，可选值： Required 必须每个节点调度一个 Preferred 尽可能每个节点调度一个
                  None 不设置均衡调度
                enum:
                - Required
                - Preferred
                - None
                minLength: 1
                type: string
              config:
                description: 自定义配置项
                nullable: true
                properties:
                  flink-conf.yaml:
                    description: 对应 $FLINK_HOME/conf/flink-conf.yaml ，不写使用镜像内预制配置文件
                    nullable: true
                    type: string
                  log4j-console.properties:
                    description: 对应 $FLINK_HOME/conf/log4j-console.properties ，不写使用镜像内预制配置文件
                    nullable: true
                    type: string
                  logback-console.xml:
                    description: 对应 $FLINK_HOME/conf/logback-console.xml ，不写使用镜像内预制配置文件
                    nullable: true
                    type: string
                type: object
              ha:
                description: flink ha 配置
                properties:
                  path:
                    description: 仅 zookeeper ha 生效，配置 ha 路径前缀
                    nullable: true
                    type: string
                  quorum:
                    description: 仅 zookeeper ha 生效，配置 zk 地址
                    nullable: true
                    type: string
                  type:
                    description: ha 类型，允许值 zookeeper  kubernetes none
                    enum:
                    - zookeeper
                    - kubernetes
                    - none
                    type: string
                type: object
              image:
                description: 填写 flink 运行镜像 ,这个镜像为 flink taskmanager 以及 jobmanager
                  共用，不支持双镜像，必填
                minLength: 1
                type: string
              imageSecret:
                description: 填写 flink 镜像拉取 secret
                type: string
              nodeSelector:
                additionalProperties:
                  type: string
                description: NodeSelector
                nullable: true
                type: object
              numberOfTaskSlots:
                description: taskmanager 可用槽位，对应 taskmanager.numberOfTaskSlots
                format: int32
                minimum: 1
                type: integer
              resource:
                description: flink 运行资源配置
                properties:
                  jobManager:
                    description: jobmanager 资源配置
                    properties:
                      cpu:
                        description: kubernetes.jobmanager.cpu
                        type: string
                      jvm-metaspace:
                        description: jobmanager.memory.jvm-metaspace.size
                        type: string
                      memory:
                        description: jobmanager.memory.process.size
                        type: string
                      off-heap:
                        description: jobmanager.memory.off-heap.size
                        type: string
                    type: object
                  taskManager:
                    description: taskmanager 资源配置
                    properties:
                      cpu:
                        description: kubernetes.taskmanager.cpu
                        type: string
                      framework:
                        properties:
                          heap:
                            description: taskmanager.memory.framework.heap.size
                            type: string
                          off-heap:
                            description: taskmanager.memory.framework.off-heap.size
                            type: string
                        type: object
                      jvm-metaspace:
                        description: taskmanager.memory.jvm-metaspace.size
                        type: string
                      managed:
                        properties:
                          fraction:
                            description: taskmanager.memory.managed.fraction ， 与 max
                              min 仅其中一个配置生效，默认走max min
                            type: string
                          max:
                            description: taskmanager.memory.managed.max ， 与 max min
                              仅其中一个配置生效，默认走max min
                            type: string
                          min:
                            description: taskmanager.memory.managed.min， 与 max min
                              仅其中一个配置生效，默认走max min
                            type: string
                        type: object
                      memory:
                        description: taskmanager.memory.process.size
                        type: string
                      netWork:
                        properties:
                          fraction:
                            description: taskmanager.memory.network.fraction ， 与 max
                              min 仅其中一个配置生效，默认走max min
                            type: string
                          max:
                            description: taskmanager.memory.network.max ， 与 max min
                              仅其中一个配置生效，默认走max min
                            type: string
                          min:
                            description: taskmanager.memory.network.min， 与 max min
                              仅其中一个配置生效，默认走max min
                            type: string
                        type: object
                      task:
                        properties:
                          off-heap:
                            description: taskmanager.memory.task.off-heap.size
                            type: string
                        type: object
                    type: object
                type: object
              s3:
                description: S3 配置
                properties:
                  accessKey:
                    description: s3.access-key
                    minLength: 1
                    type: string
                  bucket:
                    description: 部署 bucket
                    minLength: 1
                    type: string
                  endPoint:
                    description: s3.endpoint
                    minLength: 1
                    type: string
                  secretKey:
                    description: s3.secret-key
                    minLength: 1
                    type: string
                required:
                - bucket
                type: object
              sa:
                description: SA，填写集群运行的 k8s service account 配置
                minLength: 1
                type: string
            type: object
          status:
            description: FlinkSessionStatus defines the observed state of FlinkSession
            properties:
              port:
                format: int32
                type: integer
              ready:
                type: boolean
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
